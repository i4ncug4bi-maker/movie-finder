<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{{ movie.title }} ({{ movie.year }}) - Details</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #0b1120;
            color: #e5e7eb;
            margin: 0;
            padding: 0;
        }

        header {
            background-color: #111827;
            padding: 16px 24px;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        header a {
            color: #e5e7eb;
            text-decoration: none;
            font-weight: bold;
        }

        header a:hover {
            text-decoration: underline;
        }

        .container {
            max-width: 1100px;
            margin: 24px auto;
            padding: 0 16px;
        }

        .movie-layout {
            display: flex;
            flex-wrap: wrap;
            gap: 24px;
        }

        .poster {
            flex: 0 0 250px;
        }

        .poster img {
            width: 100%;
            border-radius: 12px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.7);
        }

        .details {
            flex: 1 1 300px;
        }

        .title {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 8px;
        }

        .meta {
            color: #9ca3af;
            margin-bottom: 8px;
        }

        .genres {
            margin-bottom: 16px;
            color: #9ca3af;
        }

        .badge {
            display: inline-block;
            background-color: #1f2937;
            color: #e5e7eb;
            border-radius: 999px;
            padding: 4px 10px;
            font-size: 12px;
            margin-right: 6px;
            margin-bottom: 4px;
        }

        .section-title {
            margin-top: 24px;
            margin-bottom: 8px;
            font-size: 18px;
            font-weight: bold;
        }

        .overview {
            line-height: 1.5;
            margin-bottom: 16px;
        }

        .trailer-link a {
            color: #60a5fa;
            text-decoration: none;
        }

        .trailer-link a:hover {
            text-decoration: underline;
        }

        .region-form {
            margin-top: 16px;
            margin-bottom: 8px;
        }

        .region-form select {
            padding: 4px 8px;
            border-radius: 6px;
            border: 1px solid #4b5563;
            background-color: #111827;
            color: #e5e7eb;
        }

        .where-list p {
            margin: 4px 0;
        }

        .no-providers {
            color: #9ca3af;
            font-style: italic;
        }

        hr {
            border: 0;
            border-top: 1px solid #1f2937;
            margin: 16px 0;
        }

        @media (max-width: 768px) {
            .movie-layout {
                flex-direction: column;
            }
            .poster {
                max-width: 250px;
                margin: 0 auto;
            }
        }
    </style>
</head>

<body>
<header>
    <a href="javascript:history.back()" class="back-link">← Back to results</a>
    <span>MovieFinder</span>
</header>

<div class="container">
    <div class="movie-layout">
        <div class="poster">
            {% if movie.poster_url %}
                <img src="{{ movie.poster_url }}" alt="{{ movie.title }}">
            {% else %}
                <div style="width:100%;height:360px;background:#1f2937;border-radius:12px;display:flex;align-items:center;justify-content:center;color:#6b7280;">
                    No poster available
                </div>
            {% endif %}
        </div>

        <div class="details">
            <div class="title">
                {{ movie.title }}
                {% if movie.year %}
                    <span style="color:#9ca3af;font-weight:normal;">({{ movie.year }})</span>
                {% endif %}
            </div>

            <div class="meta">
                {% if movie.rating %}
                    ⭐ {{ movie.rating }}/10
                {% endif %}
                {% if movie.votes %}
                    · {{ movie.votes }} votes
                {% endif %}
            </div>

            {% if movie.genres %}
                <div class="genres">
                    {% for g in movie.genres %}
                        <span class="badge">{{ g }}</span>
                    {% endfor %}
                </div>
            {% endif %}

            <div class="section-title">Overview</div>
            <div class="overview">
                {% if movie.overview %}
                    {{ movie.overview }}
                {% else %}
                    <span class="no-providers">No overview available.</span>
                {% endif %}
            </div>

            {% if movie.trailer_url %}
                <div class="section-title">Trailer</div>
                <div class="trailer-link">
                    <a href="{{ movie.trailer_url }}" target="_blank" rel="noopener noreferrer">
                        ▶ Watch trailer on YouTube
                    </a>
                </div>
            {% endif %}

            <hr>

            <!-- Select Region -->
            <div class="region-form">
                <form method="get" action="">
                    <label for="region">Select region for "Where to watch":</label>
                    <select id="region" name="region" onchange="this.form.submit()">
                        {% for code, name in regions %}
                            <option value="{{ code }}" {% if code == region %}selected{% endif %}>
                                {{ code }} - {{ name }}
                            </option>
                        {% endfor %}
                    </select>
                </form>
            </div>

            <div class="section-title">
                Where to Watch ({{ region }})
            </div>

            {% set wt = movie.where_to_watch %}
            <div class="where-list">
                {% if wt.stream or wt.buy or wt.rent %}

                    {% if wt.stream %}
                        <p><strong>Streaming:</strong> {{ wt.stream | join(', ') }}</p>
                    {% endif %}

                    {% if wt.buy %}
                        <p><strong>Buy:</strong> {{ wt.buy | join(', ') }}</p>
                    {% endif %}

                    {% if wt.rent %}
                        <p><strong>Rent:</strong> {{ wt.rent | join(', ') }}</p>
                    {% endif %}

                {% else %}
                    <p class="no-providers">
                        No provider information available for this region.
                    </p>
                {% endif %}
            </div>
        </div>
    </div>
</div>
</body>
</html>
